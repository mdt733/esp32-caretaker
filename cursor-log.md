у меня есть ESP32-CAM, мне нужно научиться разрабатывать под неё эффективный / оптимальный код для робота, который будет передавать картинку с камеры в режиме реального времени и при этом управлять 2 моторами.

Давай начнем с азов - инициализируем проект в platformio с  минимальной прошивкой для мигания встроенным в esp32-cam светодиодом

---

добавь вывод логов в порт

---

теперь давай использовать многопоточность и таски esp32

---

а можем разнести эти 2 задачи на разные ядра?

---

теперь нужно подсчитать какой процент времени кажое из ядер заняты работой

---

давай настроим FreeRTOS в platformio. Сейчас ошибка

---

/home/ubuntu/Arduino/ESP32-CAM_TESTS/src/main.cpp:79: undefined reference to `vTaskGetRunTimeStats'
collect2: error: ld returned 1 exit status
*** [.pio/build/esp32cam/firmware.elf] Error 1

все еще ошибка, давай переключаться на esp-idf

---

Я запускаю через platformio:
main/main.cpp переименовал в src/main.cpp, т.к. platformio необходима папка src.
Также есть ошибки в main.cpp, что не так?

---

теперь такие ошибки

---

все ок, для истории вывод из терминала:

LED is toggling
Run Time Stats:
Stats           69411           <1%
IDLE0           25061128                99%
IDLE1           25017325                99%
Log             3193            <1%
Blink           9829            <1%
ipc0            9376            <1%
ipc1            10137           <1%
Tmr Svc         21              <1%

---

давай снизим яркость светодиода до 20%

---

есть ошибки x3

---

давай разнесам по отдельным файлам код

---

*** откат на arduino платформу, esp-idf слишком низкоуровневая

---

теперь нужно подсчитать какой процент времени кажое из ядер заняты работой, но на arduino, без использования специфичных для esp-idf функций - давай руками считать время затраченное в каждом таске с привязкой к ядру и исходя из этого считать сколько каждый  из тасков занимает процентов

---

выводи помимо процентов еще абсолютные значения в скобках

---

не накапливай итог, нужно сбрасывать после вывода на экран

---

а можно считать не миллисекунды а микросекунды? В миллисекундах по нулям все 

---

разнеси код по файлам - каждый таск - отдельный h и cpp файл. Все h файлы помещай в src/include

---

сделай яркость светодиода 0.5%

---

добавь подключение к wifi, доступы для подключения лежат в .env. Отдельную задачу можно не создавать, нужно просто подключение к сети (и переподключение на случай если сеть отвалится)

---

ssid не подтягивается в platformio.ini

---

давай лучше на bash

---

